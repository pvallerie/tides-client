(this["webpackJsonptides-client"]=this["webpackJsonptides-client"]||[]).push([[0],{56:function(e,t,n){},57:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(24),o=n.n(r),c=n(22),s=(n(55),n(56),n(15)),i=n(16),l=n(20),u=n(19),d=(n.p,n(57),n(7)),j=n(26),h=n(50),b=n(2),m=["user","component","render"],p=function(e){var t=e.user,n=e.component,a=e.render,r=Object(h.a)(e,m);return t&&a?Object(b.jsx)(d.b,Object(j.a)(Object(j.a)({},r),{},{render:a})):Object(b.jsx)(d.b,Object(j.a)(Object(j.a)({},r),{},{render:function(e){return t?Object(b.jsx)(n,Object(j.a)({},e)):Object(b.jsx)(d.a,{to:"/"})}}))},O=n(27),f=n(39),x=Object(b.jsx)(a.Fragment,{children:Object(b.jsx)(O.a.Link,{href:"#/sign-out",children:"Sign Out"})}),g=Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)(O.a.Link,{href:"#/sign-up",children:"Sign Up"}),Object(b.jsx)(O.a.Link,{href:"#/sign-in",children:"Sign In"})]}),v=function(e){var t=e.user;return Object(b.jsxs)(f.a,{children:[Object(b.jsx)(f.a.Brand,{children:"Tides"}),Object(b.jsx)(O.a,{children:t?x:g})]})},w=n(17),y="https://tides-api.herokuapp.com",C="http://localhost:8000/api",k="localhost"===window.location.hostname?C:y,S=n(9),L=n.n(S),E=function(e){return L()({method:"POST",url:k+"/sign-in/",data:{credentials:{email:e.email,password:e.password}}})},U=n(6),I=n(23),T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChange=function(e){return a.setState(Object(w.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t,n=a.props,r=n.setUser,o=n.history;(t=a.state,L()({method:"POST",url:k+"/sign-up/",data:{credentials:{email:t.email,password:t.password,password_confirmation:t.passwordConfirmation}}})).then((function(){return E(a.state)})).then((function(e){r(e.data.user),a.state.token=e.data.user.token})).then((function(){return e=a.state,L()({url:k+"/locations",method:"POST",headers:{Authorization:"Token ".concat(e.token)},data:{location:{name:e.location}}});var e})).then((function(){return o.push("/home")})).catch((function(e){return console.error("ERROR: ",e.message)}))},a.state={email:"",password:"",passwordConfirmation:"",location:""},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.passwordConfirmation,r=e.location;return Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"col-sm-10 col-md-8 mx-auto mt-5",children:[Object(b.jsx)("h3",{children:"Sign Up"}),Object(b.jsxs)(U.a,{onSubmit:this.handleSubmit,children:[Object(b.jsxs)(U.a.Group,{controlId:"email",children:[Object(b.jsx)(U.a.Label,{children:"Email address"}),Object(b.jsx)(U.a.Control,{required:!0,type:"email",name:"email",value:t,placeholder:"Enter email",onChange:this.handleChange})]}),Object(b.jsxs)(U.a.Group,{controlId:"password",children:[Object(b.jsx)(U.a.Label,{children:"Password"}),Object(b.jsx)(U.a.Control,{required:!0,name:"password",type:"password",value:n,placeholder:"Password",onChange:this.handleChange})]}),Object(b.jsxs)(U.a.Group,{controlId:"passwordConfirmation",children:[Object(b.jsx)(U.a.Label,{children:"Password Confirmation"}),Object(b.jsx)(U.a.Control,{required:!0,name:"passwordConfirmation",type:"password",value:a,placeholder:"Confirm Password",onChange:this.handleChange})]}),Object(b.jsxs)(U.a.Group,{controlId:"location",children:[Object(b.jsx)(U.a.Label,{children:"Location"}),Object(b.jsx)(U.a.Control,{required:!0,name:"location",type:"text",value:r,placeholder:"Enter your location",onChange:this.handleChange})]}),Object(b.jsx)(I.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})}}]),n}(a.Component),P=Object(d.f)(T),q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChange=function(e){return a.setState(Object(w.a)({},e.target.name,e.target.value))},a.onSignIn=function(e){e.preventDefault();var t=a.props,n=t.setUser,r=t.history;E(a.state).then((function(e){return n(e.data.user)})).then((function(){return r.push("/home")})).catch((function(e){return console.error("ERROR: ",e.message)}))},a.state={email:"",password:""},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password;return Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"col-sm-10 col-md-8 mx-auto mt-5",children:[Object(b.jsx)("h3",{children:"Sign In"}),Object(b.jsxs)(U.a,{onSubmit:this.onSignIn,children:[Object(b.jsxs)(U.a.Group,{controlId:"email",children:[Object(b.jsx)(U.a.Label,{children:"Email address"}),Object(b.jsx)(U.a.Control,{required:!0,type:"email",name:"email",value:t,placeholder:"Enter email",onChange:this.handleChange})]}),Object(b.jsxs)(U.a.Group,{controlId:"password",children:[Object(b.jsx)(U.a.Label,{children:"Password"}),Object(b.jsx)(U.a.Control,{required:!0,name:"password",value:n,type:"password",placeholder:"Password",onChange:this.handleChange})]}),Object(b.jsx)(I.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})}}]),n}(a.Component),A=Object(d.f)(q),G=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e,t=this.props,n=(t.msgAlert,t.history),a=t.clearUser,r=t.user;(e=r,L()({url:k+"/sign-out/",method:"DELETE",headers:{Authorization:"Token ".concat(e.token)}})).finally((function(){return n.push("/sign-in")})).finally((function(){return a()}))}},{key:"render",value:function(){return""}}]),n}(a.Component),N=Object(d.f)(G),R=n(25),z=function(e){var t=e.changeLocation,n=(e.location,Object(a.useState)({})),r=Object(R.a)(n,2),o=r[0],c=r[1];return Object(b.jsxs)(U.a,{onSubmit:function(e){e.preventDefault(),e.target.reset(),t(o.name)},children:[Object(b.jsxs)(U.a.Group,{controlId:"newLocation",children:[Object(b.jsx)(U.a.Label,{children:"Change Location"}),Object(b.jsx)(U.a.Control,{type:"text",placeholder:"Enter new location",name:"name",onChange:function(e){e.persist(),c((function(t){var n=Object(w.a)({},e.target.name,e.target.value);return Object.assign({},t,n)}))}})]}),Object(b.jsx)(I.a,{variant:"primary",type:"submit",children:"Submit"})]})},D=function(e){var t=e.user,n=Object(a.useState)({name:""}),r=Object(R.a)(n,2),o=r[0],c=r[1],s=Object(a.useState)(null),i=Object(R.a)(s,2),l=i[0],u=i[1],d=Object(a.useState)(null),j=Object(R.a)(d,2),h=j[0],m=j[1];Object(a.useEffect)((function(){var e;(e=t,L()({url:k+"/locations",method:"GET",headers:{Authorization:"Token ".concat(e.token)}})).then((function(e){console.log(e);var n=e.data.locations.find((function(e){return e.owner.id===t.id}));return c(n),n})).then((function(e){var t="https://api.opencagedata.com/geocode/v1/json?q=".concat(e.name,"&key=4c4a96fe14474c8097b3f465760faede&countrycode=us");L.a.get(t).then((function(e){var t=e.data.results[0];return[t.geometry.lat,t.geometry.lng]})).then((function(e){var t=e[0],n=e[1],a="https://www.worldtides.info/api/v2?extremes&date=today&lat=".concat(t,",&lon=").concat(n,"&key=b3b2c2e6-070f-4d4c-927e-ae381d5beef6&timezone&localtime");return L.a.get(a)})).then((function(e){var t=null,n=null,a=e.data.extremes,r=a[0].dt;new Date(r);return"High"===a[0].type?t=a[0].date:n=a[0].date,"High"===a[1].type?t=a[1].date:n=a[1].date,[t,n]})).then((function(e){u(e[0]),m(e[1])}))}))}),[]);return Object(b.jsxs)(a.Fragment,{children:[Object(b.jsxs)("p",{children:["Location: ",o.name]}),Object(b.jsxs)("p",{children:["Next High: ",l]}),Object(b.jsxs)("p",{children:["Next Low: ",h]}),Object(b.jsx)(z,{changeLocation:function(e){var n=o;n.name=e,c(n),function(e,t,n){L()({url:k+"/locations/"+e+"/",method:"PATCH",headers:{Authorization:"Token ".concat(n.token)},data:{location:t}})}(n.id,n,t);var a=function(e){var t=[];return function(){var n="https://api.opencagedata.com/geocode/v1/json?q=".concat(e.name,"&key=4c4a96fe14474c8097b3f465760faede&countrycode=us");L.a.get(n).then((function(e){var t=e.data.results[0];return[t.geometry.lat,t.geometry.lng]})).then((function(e){var t=e[0],n=e[1],a="https://www.worldtides.info/api/v2?extremes&date=today&lat=".concat(t,",&lon=").concat(n,"&key=b3b2c2e6-070f-4d4c-927e-ae381d5beef6&timezone&localtime");return L.a.get(a)})).then((function(e){var n=null,a=null,r=e.data.extremes;return"High"===r[0].type?n=r[0].date:a=r[0].date,"High"===r[1].type?n=r[1].date:a=r[1].date,t=[n,a]}))}(),console.log("nextTides: ",t),t}(o);u(a[0]),m(a[1])},location:o,user:t})]})},H=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).setUser=function(e){return a.setState({user:e})},a.clearUser=function(){return a.setState({user:null})},a.state={user:null,msgAlerts:[]},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=this.state.user;return Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)(v,{user:t}),Object(b.jsxs)("main",{className:"container",children:[Object(b.jsx)(d.b,{path:"/sign-up",render:function(){return Object(b.jsx)(P,{setUser:e.setUser})}}),Object(b.jsx)(d.b,{path:"/sign-in",render:function(){return Object(b.jsx)(A,{setUser:e.setUser})}}),Object(b.jsx)(p,{user:t,path:"/sign-out",render:function(){return Object(b.jsx)("p",{children:"Authenticated Route works!"})}}),Object(b.jsx)(p,{user:t,path:"/home",render:function(){return Object(b.jsx)(D,{user:t})}}),Object(b.jsx)(p,{user:t,path:"/sign-out",render:function(){return Object(b.jsx)(N,{clearUser:e.clearUser,user:t})}})]})]})}}]),n}(a.Component),F=Object(b.jsx)(c.a,{children:Object(b.jsx)(H,{})});o.a.render(F,document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.74416d69.chunk.js.map